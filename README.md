# CSF-QA-TEST â€” API Automation (Postman + Newman)
<!-- Status: CI -->
[![API Tests](https://github.com/mmrodrigues-rj/csf-qa-test/actions/workflows/api-tests.yml/badge.svg?branch=main)](https://github.com/mmrodrigues-rj/csf-qa-test/actions/workflows/api-tests.yml)
[![Negative API Tests](https://github.com/mmrodrigues-rj/csf-qa-test/actions/workflows/negative-tests.yml/badge.svg?branch=main)](https://github.com/mmrodrigues-rj/csf-qa-test/actions/workflows/negative-tests.yml)


Automated API testing project based on **ServeRest** (https://serverest.dev) developed as part of the **Banco Carrefour QA Challenge**.

---

## ğŸ“Š Overview
This project validates CRUD and authentication behavior in the ServeRest API using Postman and Newman. It includes:

- âœ… Auth flow (user creation and JWT login)
- âœ… CRUD operations on `/usuarios`
- âœ… Negative scenarios (duplicate email, missing required fields, invalid ID, invalid payload)
- âœ… Rate limit validation with tolerance for 429 responses

---

## ğŸ”§ Folder Structure
```bash
CSF-QA-TEST/
â”œâ”€â”€ .github/workflows/
â”‚   â”œâ”€â”€ api-tests.yml             # Main Newman workflow for all tests
â”‚   â””â”€â”€ negative-tests.yml        # Workflow for negative test suite only
â”œâ”€â”€ postman/
â”‚   â”œâ”€â”€ collection.json           # Test definitions
â”‚   â””â”€â”€ environment.json          # Local environment variables
â”œâ”€â”€ reports/                      # Newman reports (HTML/JSON)
â”œâ”€â”€ README.md                     # This documentation
```

---

## ğŸ–¥ï¸ Requirements
- [Postman Desktop](https://www.postman.com/downloads/)
- [Node.js](https://nodejs.org/) v18+
- [Newman](https://www.npmjs.com/package/newman)

Install Newman globally:
```bash
npm install -g newman newman-reporter-htmlextra
```

---

## ğŸ”‘ Environment Variables
Located in `postman/environment.json`:

| Variable | Description | Example |
|-----------|--------------|----------|
| `base_url` | Base URL of ServeRest | `https://serverest.dev` |
| `admin_email` | Admin login email | `admin.qa.1761289133@exemplo.com` |
| `admin_password` | Password for admin | `123456` |
| `jwt` | Token (auto-filled during tests) | *(generated)* |
| `createdUserId` | User ID created in tests | *(auto)* |

---

## ğŸ§® Running Tests (Postman)
1. Import both files from `/postman` folder into Postman.
2. Select **Environment â†’ CSF-QA-TEST - Local**.
3. Run manually or via **Collection Runner**.

To run all folders (Auth, CRUD, Negatives, Rate Limit):
```bash
Ctrl + R  # or Runner â†’ Run Collection
```

---

## ğŸ§° Running via Newman
Run the full suite directly from CLI:

```bash
newman run postman/collection.json   -e postman/environment.json   -r cli,htmlextra   --reporter-htmlextra-export reports/index.html
```

This will generate:
```
reports/index.html
```
which you can open in your browser for a detailed test summary.

---

## ğŸ“ Reports
After each run, Newman saves reports inside the `/reports` folder.

| File | Description |
|------|--------------|
| `index.html` | Visual HTML report generated by `htmlextra` |
| `newman-report.json` | Raw JSON report (optional, useful for CI/CD pipelines) |

Open the file `reports/index.html` in your browser to view detailed test results, charts, and metrics.

Example of full report generation:
```bash
newman run postman/collection.json   -e postman/environment.json   -r cli,json,htmlextra   --reporter-json-export reports/newman-report.json   --reporter-htmlextra-export reports/index.html
```

---

## ğŸ“˜ Test Structure
### **1. Auth**
- `Criar Admin`: registers admin user dynamically.
- `Login`: authenticates and stores JWT in `{{jwt}}`.

### **2. Usuarios (CRUD)**
- List, create, fetch, update, delete user endpoints.

### **3. Negative Tests**
- Duplicate email validation.
- Required fields validation.
- Invalid ID and payload handling.

### **4. Rate Limit**
- Executes 30 requests to `/usuarios` to detect rate limiting (status `429` tolerated).

---

## ğŸ”„ CI/CD Integration
If you push this project to GitHub, the included workflows in `.github/workflows/` will automatically run all Postman tests through Newman.

| Workflow | Description |
|-----------|-------------|
| `api-tests.yml` | Executes the full collection (Auth, CRUD, Rate Limit) on every push or pull request. |
| `negative-tests.yml` | Runs only the *Negative Tests* folder to validate error handling and input validation. Useful for regression control and nightly jobs. |

Both workflows:
- Install Node.js and Newman.
- Run the tests using the environment file (`postman/environment.json`).
- Generate an HTML report under `/reports`.
- Upload the report as a GitHub Action artifact for download.

---

## ğŸ” Notes
- Make sure the admin user exists before first run.
- Login test dynamically updates `{{jwt}}` for dependent requests.
- The Rate Limit test may take 20â€“30 seconds.

---

## ğŸ‘¤ Author
**Marcelo Rodrigues**  
GitHub: [@mmrodrigues-rj](https://github.com/mmrodrigues-rj)

---

## ğŸ” Next Steps
- [ ] Add schema validation (Ajv) for all responses.
- [ ] Integrate automatic report publishing in GitHub Pages.
- [ ] Add test data generation from external JSON fixtures.
